"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[221],{2866:function(e,t,n){n.d(t,{ZP:function(){return k},Vq:function(){return b},Jw:function(){return T}});var r=n(14806),o=n(35250),a=n(57976),i=n(1771),s=n(19841),c=n(70079),u=n(34303),l=n(39690),d=n(31501),h=n(79876);function p(){var e=(0,r.Z)(["absolute right-0 top-1/2 -translate-y-1/2"]);return p=function(){return e},e}var f=c.forwardRef(function(e,t){var n=e.name,r=e.placeholder,a=e.type,i=e.displayName,u=e.onChange,l=e.onBlur,p=e.value,f=e.saveOnBlur,g=e.icon,v=e.onInputIconClick,y=e.className,x=(0,c.useState)(p),Z=x[0],b=x[1],T=(0,c.useCallback)(function(e){null==l||l(e),f&&b(e.target.value)},[l,f]),k=(0,c.useCallback)(function(e){null==u||u(e),f&&b(e.target.value)},[u,f]);(0,c.useEffect)(function(){b(p)},[p]);var C=(0,d.Z)({},f?{}:{value:p},f?{value:Z}:{});return(0,o.jsxs)("div",{className:(0,s.Z)("rounded-md border border-gray-300 px-3 py-2 shadow-sm focus-within:border-indigo-600 focus-within:ring-1 focus-within:ring-indigo-600",y),children:[(0,o.jsx)("label",{htmlFor:n,className:"block text-xs font-medium text-gray-900",children:i}),(0,o.jsxs)("div",{className:(0,s.Z)(i&&"mt-1","relative"),children:[(0,o.jsx)("input",(0,d.Z)({ref:t,type:a,name:n,id:n,className:(0,s.Z)("block w-full border-0 p-0 text-gray-900 placeholder-gray-500 outline-none focus:ring-0 sm:text-sm",g&&"pr-6"),placeholder:r,onBlur:T,onChange:k},C)),g&&(0,o.jsx)(m,{onClick:v,children:(0,o.jsx)(h.ZP,{icon:g})})]})]})}),m=u.Z.button(p()),g=n(44819);function v(){var e=(0,r.Z)(["form-textarea focus:ring-indigo-600 focus:border-indigo-600 block w-full sm:text-sm border-gray-300 rounded-md"]);return v=function(){return e},e}function y(){var e=(0,r.Z)(["block w-full border-0 p-0 text-gray-900 placeholder-gray-500 focus:ring-0 outline-none border-none"]);return y=function(){return e},e}function x(){var e=(0,r.Z)(["mt-1 outline-none border-0"]);return x=function(){return e},e}function Z(){var e=(0,r.Z)(["text-right"]);return Z=function(){return e},e}function b(e){return e&&(e.startsWith("http")||"custom"===e)}function T(e){return e&&!b(e)}function k(e){var t=e.children,n=(e.maxTokens,e.temperature),r=e.endOfPromptToken,u=e.onRestoreDefaults,d=e.promptPrefix,h=e.onChangePromptPrefix,p=e.modelBackend,m=e.onChangeSetting,v=e.position,y=e.settings,x=e.availableModels,Z=(0,g.ZP)(x).modelBackend,T=b(p)?"custom":Z,k=(0,c.useState)(b(T)),A=k[0],E=k[1],N=(0,c.useCallback)(function(e){h(e.target.value)},[h]),S=(0,c.useCallback)(function(e){var t=e.target.value;b(t)?(m(g.G3.Model,"custom"!==t?t:"http://custom:8000"),E(!0)):(E(!1),m(g.G3.Model,e.target.value))},[m]),P=(0,c.useCallback)(function(e){m(g.G3.EopToken,e.target.value)},[m]);(0,c.useCallback)(function(e){m(g.G3.MaxTokens,e.target.value)},[m]);var O=(0,c.useCallback)(function(e){m(g.G3.Temperature,e.target.value)},[m]);return(0,o.jsxs)(a.J,{className:"relative",children:[t,(0,o.jsx)(i.u,{as:c.Fragment,enter:"transition ease-out duration-200",enterFrom:(0,s.Z)("opacity-0","top-right"===v?"translate-x-1":"translate-y-1"),enterTo:(0,s.Z)("opacity-100","top-right"===v?"translate-x-0":"translate-y-0"),leave:"transition ease-in duration-150",leaveFrom:(0,s.Z)("opacity-100","top-right"===v?"translate-x-0":"translate-y-0"),leaveTo:(0,s.Z)("opacity-0","top-right"===v?"translate-x-1":"translate-y-1"),children:(0,o.jsx)(a.J.Panel,{className:(0,s.Z)("absolute z-20 mt-3 w-screen max-w-xs px-2 sm:px-0","bottom-center"===v&&"right-0 top-6","bottom-right"===v&&"left-2 top-8","top-right"===v&&"left-full top-1/2 ml-6 -translate-y-full"),children:(0,o.jsx)("div",{className:"overflow-hidden rounded-lg text-left text-sm shadow-lg ring-1 ring-black ring-opacity-5 dark:ring-gray-600",children:(0,o.jsxs)("div",{className:"relative grid gap-6 bg-white px-2 py-1 dark:bg-gray-800 sm:gap-4 sm:p-4",children:[y.has(g.G3.Model)&&x.length>0&&(0,o.jsx)("select",{name:"model",className:"form-select rounded-md border-gray-300 text-sm dark:text-gray-900",onChange:S,value:T,children:x.map(function(e){return(0,o.jsx)("option",{value:e.id,children:e.id},e.id)})}),A&&(0,o.jsx)(f,{displayName:"Model Endpoint",name:"modelBackend",onBlur:S,value:p,saveOnBlur:!0}),y.has(g.G3.Context)&&(0,o.jsx)(C,{value:d,onChange:N,rows:4,placeholder:"Add additional context..."}),y.has(g.G3.EopToken)&&(0,o.jsx)(f,{displayName:"End of prompt token",name:"endOfPromptToken",onBlur:P,value:r,saveOnBlur:!0}),y.has(g.G3.Temperature)&&(0,o.jsxs)("div",{className:"rounded-md border border-gray-300 px-3 py-2 shadow-sm focus-within:border-indigo-600 focus-within:ring-1 focus-within:ring-indigo-600",children:[(0,o.jsx)("label",{htmlFor:"temperature",className:"block text-xs font-medium text-gray-800",children:"Temperature"}),(0,o.jsxs)("div",{className:"mt-1",children:[(0,o.jsx)(w,{type:"number",name:"temperature",id:"temperature",onChange:O,value:n,className:"form-input"}),(0,o.jsx)(_,{name:"temperature",type:"range",min:"0",max:"1",value:n,className:"range w-full",step:"0.05",onChange:O})]})]}),(0,o.jsx)(j,{children:(0,o.jsx)(l.z,{as:"button",color:"neutral",onClick:u,children:"Restore defaults"})})]})})})})]})}var C=u.Z.textarea(v()),w=u.Z.input(y()),_=u.Z.input(x()),j=u.Z.div(Z())},44819:function(e,t,n){n.d(t,{G3:function(){return r},QZ:function(){return h},ZP:function(){return f},hY:function(){return p}});var r,o,a=n(33861),i=n(31501),s=n(61079),c=n(61432),u=n(70079),l=n(500),d=n(2866);(o=r||(r={})).Model="model",o.Temperature="temperature",o.EopToken="endOfPromptToken",o.MaxTokens="maxTokens",o.Context="context";var h="<|endofprompt|>";function p(e){return Boolean(e&&e.includes("-render"))}function f(e){var t,n,o,h,f,m,g=(0,u.useContext)(l.yP).id,v=(0,c.useRouter)(),y=v.query,x=decodeURIComponent(y[r.Model]||""),Z=(0,u.useMemo)(function(){if(x||e.length){var t,n=x||(null===(t=e.find(function(e){return"programming"===g?"special"===e.type:"chat"===g?p(e.id):"default"===e.type}))||void 0===t?void 0:t.id)||e[0].id,r=(0,d.Vq)(x)?"custom":n;return e.find(function(e){return e.id===r})}},[e,g,x]),b=(o=null==Z?void 0:Z.maxTokens,parseInt(y[r.MaxTokens]||"",10)||o||1024),T=parseFloat(y[r.Temperature]||"1"),k=(m=(null==Z?void 0:Z.eopToken)||"",decodeURIComponent(y[r.EopToken]||m)),C=(0,u.useCallback)(function(e,t){v.replace({pathname:v.basePath,query:(0,s.Z)((0,i.Z)({},y),(0,a.Z)({},e,encodeURIComponent(t)))},void 0,{shallow:!0})},[y,v]);return(0,u.useMemo)(function(){return{temperature:T,maxTokens:b,modelBackend:(null==Z?void 0:Z.id)||"",modelIsSpecial:(null==Z?void 0:Z.type)==="special",endOfPromptToken:k,onChangeModelSetting:C}},[k,C,b,null==Z?void 0:Z.id,null==Z?void 0:Z.type,T,])}},23221:function(e,t,n){n.d(t,{ZP:function(){return T}});var r=n(61706),o=n(35025),a=n(9135),i=n(31501),s=n(61079),c=n(45813),u=n(48879),l=n(44928);n(138);var d=n(22832),h=n(25829),p=n(19818),f="Something went wrong. If this issue persists please contact us through our help center at help.openai.com.";!function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(e,r,a,i,s){var c;return(0,o.Z)(this,n),(c=t.call(this,e)).name="UserError",c.userMessage=e,c.status=r||400,c.code=a,c.type=i,c.response=s,c}return n}((0,h.Z)(Error)),!function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,a=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;return(0,o.Z)(this,n),(e=t.call(this,r)).name="FatalError",e.type=a,e.response=i,e}return n}((0,h.Z)(Error)),(0,h.Z)(Error);var m=n(2866),g=n(44819),v=function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(e,r,a,i){var s;return(0,o.Z)(this,n),(s=t.call(this,e)).name="UserError",s.userMessage=e,s.status=r||400,s.code=a||null,s.type=i||null,s}return n}((0,h.Z)(Error)),y=function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(){var e,r,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"An error occurred. If this issue persists please contact us through our help center at help.openai.com.",i=arguments.length>1?arguments[1]:void 0;return(0,o.Z)(this,n),(e=t.call(this,(r=a,r&&(r.startsWith("Rate limit reached for")||r.startsWith("End-user exceeded rate-limit"))?"We're sorry, but we limit the number of requests one user can make in a certain timeframe. Please hang tight and try again in a little while.":r))).name="FatalError",e.type=i||null,e}return n}((0,h.Z)(Error)),x=n(24638),Z="https://chat.openai.com/backend-api",b=function(){function e(){(0,o.Z)(this,e)}return e.setAccessToken=function(e){this.accessToken=e},e.getAuthHeader=function(e){return{Authorization:"Bearer ".concat(e||this.accessToken)}},e.refreshApiKey=function(){var e=this;if(this.apiKeyRefreshing)return this.apiKeyRefreshing;var t=this;return this.apiKeyRefreshing=(0,r.Z)(function(){var e;return(0,c.__generator)(this,function(n){switch(n.label){case 0:return[4,(0,l.getSession)()];case 1:return(e=n.sent())&&t.setAccessToken(e.accessToken),[2];case 2:throw Error("Cannot refresh access token outside of browser");case 3:return[2]}})})(),setTimeout(function(){e.apiKeyRefreshing=null},6e4),this.apiKeyRefreshing},e.fetch=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=this;return(0,r.Z)(function(){var r,a,u,l;return(0,c.__generator)(this,function(c){switch(c.label){case 0:return[4,fetch(e,t)];case 1:if((r=c.sent()).status>=500)throw new y;if(!(r.status>=400))return[3,9];return[4,r.json()];case 2:if(u=(null==(a=c.sent())?void 0:a.detail)||(null==a?void 0:a.error),console.error("API error",e,u),!((null==u?void 0:u.code)==="expired_session_key"||(null==u?void 0:u.code)==="token_expired"))return[3,8];c.label=3;case 3:if(c.trys.push([3,6,,7]),n.isRetry)return[3,5];return[4,o.refreshApiKey()];case 4:return c.sent(),[2,o.fetch(e,t,(0,s.Z)((0,i.Z)({},n),{isRetry:!0}))];case 5:return[3,7];case 6:return l=c.sent(),console.error("Failed to refresh expired access token: ".concat(l)),[3,7];case 7:window._oaiHandleSessionExpired(),c.label=8;case 8:if(null==u?void 0:u.type)throw new v((null==u?void 0:u.message)||u,r.status,null==u?void 0:u.code,null==u?void 0:u.type);throw new y;case 9:if(204===r.status)return[2,{}];return[2,r.json()]}})})()},e.getArtifacts=function(){return this.fetch("".concat(Z,"/artifacts"),{method:"GET",headers:(0,i.Z)({"Content-Type":"application/json"},this.getAuthHeader())})},e.createArtifact=function(e){return this.fetch("".concat(Z,"/artifacts"),{method:"POST",headers:(0,i.Z)({"Content-Type":"application/json"},this.getAuthHeader()),body:JSON.stringify({url:e,contents:"\n"})})},e.sendDocument=function(){return this.fetch("".concat(Z,"/private"),{method:"GET",headers:{"Content-Type":"application/json"}})},e.getRetrievalResults=function(e){return this.fetch("".concat(Z,"/retrieval/public_data"),{method:"POST",headers:(0,i.Z)({"Content-Type":"application/json"},this.getAuthHeader()),body:JSON.stringify({query:e})})},e.getModels=function(e){return this.fetch("".concat(Z,"/models"),{method:"GET",headers:(0,i.Z)({"Content-Type":"application/json"},this.getAuthHeader(e))})},e.getConversations=function(e,t,n){var r=new URLSearchParams({offset:e.toString(),limit:t.toString()});return this.fetch("".concat(Z,"/conversations?").concat(r),{method:"GET",headers:(0,i.Z)({"Content-Type":"application/json"},this.getAuthHeader(n))})},e.getConversation=function(e,t,n){var r=n?"".concat(x.env.INTERNAL_API_URL,"/api"):Z;return this.fetch("".concat(r,"/conversation/").concat(e),{method:"GET",headers:(0,i.Z)({"Content-Type":"application/json"},this.getAuthHeader(t))})},e.generateTitle=function(e,t,n){return this.fetch("".concat(Z,"/conversation/gen_title/").concat(e),{method:"POST",headers:(0,i.Z)({"Content-Type":"application/json"},this.getAuthHeader()),body:JSON.stringify({message_id:t,model:n})})},e.patchConversation=function(e,t){return this.fetch("".concat(Z,"/conversation/").concat(e),{method:"PATCH",headers:(0,i.Z)({"Content-Type":"application/json"},this.getAuthHeader()),body:JSON.stringify(t)})},e.deleteConversations=function(){return this.fetch("".concat(Z,"/conversations"),{method:"PATCH",headers:(0,i.Z)({"Content-Type":"application/json"},this.getAuthHeader()),body:JSON.stringify({is_visible:!1})})},e.getServiceMessaging=function(){var e="false"===x.env.BLOCK_LOGIN,t=this.fetch("".concat(x.env.INTERNAL_API_URL,"/public/status"),{method:"GET",headers:{"Content-Type":"application/json"}});return e?(0,s.Z)((0,i.Z)({},t),{oof:!1}):t},e.publicApiCompletionStream=function(e,t,n){var o=this;return(0,r.Z)(function(){var s,l,d,h;return(0,c.__generator)(this,function(h){return s=new AbortController,l=e.url.startsWith("https://api.openai.com")?{prompt:t.prompt||"",max_tokens:t.maxTokens,temperature:t.temperature,stop:t.stop||[""],stream:!0}:(0,g.hY)(e.model)?{action:t.completionType,messages:t.messages,conversation_id:t.threadId,parent_message_id:t.parentMessageId,model:e.model}:{query:t.prompt||"",url:t.url,max_tokens:t.maxTokens,temperature:t.temperature,stop:t.stop||[""],stream:!0,model:e.model},d=(0,m.Vq)(e.model)?{"X-OpenAI-Preferred-Model-Url":e.url||"",Authorization:"Bearer 1"}:void 0,(0,u.L)(e.url,{method:"POST",headers:(0,i.Z)({"Content-Type":"application/json","X-OpenAI-Assistant-App-Id":e.appId||""},o.getAuthHeader(),d),body:JSON.stringify(l),signal:s.signal,openWhenHidden:!0,onopen:function(e){return(0,r.Z)(function(){var t,n,r;return(0,c.__generator)(this,function(o){switch(o.label){case 0:if(t=e.headers.get("content-type")||"",e.ok&&t.includes("text/event-stream"))return[2];if(!t.includes("application/json"))return[3,2];return[4,e.json()];case 1:if(n=o.sent(),console.error(n),r=(null==n?void 0:n.error)||(null==n?void 0:n.detail)){if(e.status>=500)throw new y((null==r?void 0:r.message)||r);throw((null==r?void 0:r.code)==="expired_session_key"||(null==r?void 0:r.code)==="invalid_api_key"||(null==r?void 0:r.code)==="token_expired")&&window._oaiHandleSessionExpired(),new v((null==r?void 0:r.message)||r,e.status,null==r?void 0:r.code,null==r?void 0:r.type)}o.label=2;case 2:throw new y}})})()},onmessage:function(e){if("[DONE]"===e.data)s.abort(),n({finish_reason:"stop"});else if("ping"===e.event)console.error("PING RECEIVED",e);else try{var t,r=JSON.parse(e.data);if(r.error)throw new y(r.error.message);r.message?n({message:r.message,threadId:r.conversation_id}):n({id:r.id,text:r.choices[0].text,finish_reason:r.choices[0].finish_reason})}catch(o){if(void 0!==(t=o).userMessage)throw new y(o.message)}},onerror:function(e){throw"Failed to fetch"===e.message&&(e=new y("An error occurred. Either the engine you requested does not exist or there was another issue processing your request. If this issue persists please contact us through our help center at help.openai.com.")),n({err:e}),e}}).catch(function(e){(0,a.Z)(e,v)||(0,a.Z)(e,y)||console.error(e)}),[2,s]})})()},e.runModerationApi=function(e,t,n){return this.fetch("".concat("https://chat.openai.com/backend-api","/moderations"),{method:"POST",headers:(0,i.Z)({"Content-Type":"application/json"},this.getAuthHeader()),body:JSON.stringify({input:e,model:"text-moderation-playground",conversation_id:t,message_id:n})})},e.submitMessageFeedback=function(e){return this.fetch("".concat(Z,"/conversation/message_feedback"),{method:"POST",headers:(0,i.Z)({"Content-Type":"application/json"},this.getAuthHeader()),body:JSON.stringify(e)})},e.getRateLimitCaptchaId=function(e){var t=this;return(0,r.Z)(function(){return(0,c.__generator)(this,function(n){switch(n.label){case 0:return[4,t.fetch("".concat(Z,"/check_data_captcha"),{method:"GET",headers:(0,i.Z)({"Content-Type":"application/json"},t.getAuthHeader(e))})];case 1:return[2,n.sent()]}})})()},e.getRateLimitCaptchaItem=function(e,t){return this.fetch("".concat(Z,"/data_captcha/").concat(e),{method:"GET",headers:(0,i.Z)({"Content-Type":"application/json"},this.getAuthHeader(t))})},e.getCaptchaDisplayStatus=function(e){return this.fetch("".concat(Z,"/crosswalk"),{method:"GET",headers:(0,i.Z)({"Content-Type":"application/json"},this.getAuthHeader(e))})},e.submitRateLimitCaptchaResponse=function(e,t){return this.fetch("".concat(Z,"/data_captcha/").concat(e.captchaId),{method:"POST",headers:(0,i.Z)({"Content-Type":"application/json"},this.getAuthHeader(t)),body:JSON.stringify({payload:e.payload,metadata:e.metadata})})},e}();b.auth0Client=null;var T=b}}]);