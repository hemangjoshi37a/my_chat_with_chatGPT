"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[814],{60814:function(e,t,n){n.d(t,{ZP:function(){return _}});var o=n(61706),r=n(35025),a=n(9135),s=n(31501),i=n(61079),c=n(45813),h=n(48879),u=n(44928);n(138);var d=n(34388),l=n(22832),p=n(25829),f=n(19818),g=function(e){(0,l.Z)(n,e);var t=(0,f.Z)(n);function n(e,o,a,s){var i;return(0,r.Z)(this,n),(i=t.call(this,e)).name="UserError",i.userMessage=e,i.status=o||400,i.code=a||null,i.type=s||null,i}return n}((0,p.Z)(Error)),m=function(e){(0,l.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,o,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"An error occurred. If this issue persists please contact us through our help center at help.openai.com.",s=arguments.length>1?arguments[1]:void 0;return(0,r.Z)(this,n),(e=t.call(this,(o=a,o&&(o.startsWith("Rate limit reached for")||o.startsWith("End-user exceeded rate-limit"))?"We're sorry, but we limit the number of requests one user can make in a certain timeframe. Please hang tight and try again in a little while.":o))).name="FatalError",e.type=s||null,e}return n}((0,p.Z)(Error)),y=n(24638),v="https://chat.openai.com/backend-api",T=function(){function e(){(0,r.Z)(this,e)}return e.setAccessToken=function(e){this.accessToken=e},e.getAuthHeader=function(e){return{Authorization:"Bearer ".concat(e||this.accessToken)}},e.refreshApiKey=function(){var e=this;if(this.apiKeyRefreshing)return this.apiKeyRefreshing;var t=this;return this.apiKeyRefreshing=(0,o.Z)(function(){var e;return(0,c.__generator)(this,function(n){switch(n.label){case 0:return[4,(0,u.getSession)()];case 1:return(e=n.sent())&&t.setAccessToken(e.accessToken),[2];case 2:throw Error("Cannot refresh access token outside of browser");case 3:return[2]}})})(),setTimeout(function(){e.apiKeyRefreshing=null},6e4),this.apiKeyRefreshing},e.fetch=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this;return(0,o.Z)(function(){var o,a,h,u,d;return(0,c.__generator)(this,function(c){switch(c.label){case 0:return[4,fetch(e,o=(0,s.Z)({credentials:"include"},t))];case 1:if((a=c.sent()).status>=500)throw new m;if(!(a.status>=400))return[3,9];return[4,a.json()];case 2:if(u=(null==(h=c.sent())?void 0:h.detail)||(null==h?void 0:h.error),console.error("API error",e,u),!((null==u?void 0:u.code)==="expired_session_key"||(null==u?void 0:u.code)==="token_expired"))return[3,8];c.label=3;case 3:if(c.trys.push([3,6,,7]),n.isRetry)return[3,5];return[4,r.refreshApiKey()];case 4:return c.sent(),[2,r.fetch(e,o,(0,i.Z)((0,s.Z)({},n),{isRetry:!0}))];case 5:return[3,7];case 6:return d=c.sent(),console.error("Failed to refresh expired access token: ".concat(d)),[3,7];case 7:window._oaiHandleSessionExpired(),c.label=8;case 8:if(null==u?void 0:u.type)throw new g((null==u?void 0:u.message)||u,a.status,null==u?void 0:u.code,null==u?void 0:u.type);throw new m;case 9:if(204===a.status)return[2,{}];return[2,a.json()]}})})()},e.getArtifacts=function(){return this.fetch("".concat(v,"/artifacts"),{method:"GET",headers:(0,s.Z)({"Content-Type":"application/json"},this.getAuthHeader())})},e.createArtifact=function(e){return this.fetch("".concat(v,"/artifacts"),{method:"POST",headers:(0,s.Z)({"Content-Type":"application/json"},this.getAuthHeader()),body:JSON.stringify({url:e,contents:"\n"})})},e.sendDocument=function(){return this.fetch("".concat(v,"/private"),{method:"GET",headers:{"Content-Type":"application/json"}})},e.getRetrievalResults=function(e){return this.fetch("".concat(v,"/retrieval/public_data"),{method:"POST",headers:(0,s.Z)({"Content-Type":"application/json"},this.getAuthHeader()),body:JSON.stringify({query:e})})},e.getModels=function(e){return this.fetch("".concat(v,"/models"),{method:"GET",headers:(0,s.Z)({"Content-Type":"application/json"},this.getAuthHeader(e))})},e.getConversations=function(e,t,n){var o=new URLSearchParams({offset:e.toString(),limit:t.toString()});return this.fetch("".concat(v,"/conversations?").concat(o),{method:"GET",headers:(0,s.Z)({"Content-Type":"application/json"},this.getAuthHeader(n))})},e.getConversation=function(e,t,n){var o=n?"".concat(y.env.INTERNAL_API_URL,"/api"):v;return this.fetch("".concat(o,"/conversation/").concat(e),{method:"GET",headers:(0,s.Z)({"Content-Type":"application/json"},this.getAuthHeader(t))})},e.generateTitle=function(e,t,n){return this.fetch("".concat(v,"/conversation/gen_title/").concat(e),{method:"POST",headers:(0,s.Z)({"Content-Type":"application/json"},this.getAuthHeader()),body:JSON.stringify({message_id:t,model:n})})},e.patchConversation=function(e,t){return this.fetch("".concat(v,"/conversation/").concat(e),{method:"PATCH",headers:(0,s.Z)({"Content-Type":"application/json"},this.getAuthHeader()),body:JSON.stringify(t)})},e.deleteConversations=function(){return this.fetch("".concat(v,"/conversations"),{method:"PATCH",headers:(0,s.Z)({"Content-Type":"application/json"},this.getAuthHeader()),body:JSON.stringify({is_visible:!1})})},e.getServiceMessaging=function(){var e="false"===y.env.BLOCK_LOGIN,t=this.fetch("".concat(y.env.INTERNAL_API_URL,"/public/status"),{method:"GET",headers:{"Content-Type":"application/json"}});return e?(0,i.Z)((0,s.Z)({},t),{oof:!1}):t},e.publicApiCompletionStream=function(e,t,n){var r=this;return(0,o.Z)(function(){var i,u,l;return(0,c.__generator)(this,function(l){return i=new AbortController,u={action:t.completionType,messages:t.messages,conversation_id:t.threadId,parent_message_id:t.parentMessageId,model:e.model},(0,h.L)("".concat("https://chat.openai.com/backend-api","/conversation"),{method:"POST",credentials:"include",headers:(0,s.Z)({"Content-Type":"application/json","X-OpenAI-Assistant-App-Id":e.appId||""},r.getAuthHeader()),body:JSON.stringify(u),signal:i.signal,openWhenHidden:!0,onopen:function(e){return(0,o.Z)(function(){var t,n,o;return(0,c.__generator)(this,function(r){switch(r.label){case 0:if(t=e.headers.get("content-type")||"",e.ok&&t.includes("text/event-stream"))return[2];if(!t.includes("application/json"))return[3,2];return[4,e.json()];case 1:if(n=r.sent(),console.error(n),o=(null==n?void 0:n.error)||(null==n?void 0:n.detail)){if(e.status>=500)throw new m((null==o?void 0:o.message)||o);throw((null==o?void 0:o.code)==="expired_session_key"||(null==o?void 0:o.code)==="invalid_api_key"||(null==o?void 0:o.code)==="token_expired")&&window._oaiHandleSessionExpired(),new g((null==o?void 0:o.message)||o,e.status,null==o?void 0:o.code,null==o?void 0:o.type)}r.label=2;case 2:throw new m}})})()},onmessage:function(e){if("[DONE]"===e.data)i.abort(),n({finish_reason:"stop"});else if("ping"===e.event)console.error("PING RECEIVED",e);else try{var t=JSON.parse(e.data);if(t.error)throw new m(t.error.message);n({message:t.message,threadId:t.conversation_id})}catch(o){if((0,d.TV)(o))throw new m(o.message)}},onerror:function(e){throw"Failed to fetch"===e.message&&(e=new m("An error occurred. Either the engine you requested does not exist or there was another issue processing your request. If this issue persists please contact us through our help center at help.openai.com.")),n({err:e}),e}}).catch(function(e){(0,a.Z)(e,g)||(0,a.Z)(e,m)||console.error(e)}),[2,i]})})()},e.runModerationApi=function(e,t,n){return this.fetch("".concat("https://chat.openai.com/backend-api","/moderations"),{method:"POST",headers:(0,s.Z)({"Content-Type":"application/json"},this.getAuthHeader()),body:JSON.stringify({input:e,model:"text-moderation-playground",conversation_id:t,message_id:n})})},e.submitMessageFeedback=function(e){return this.fetch("".concat(v,"/conversation/message_feedback"),{method:"POST",headers:(0,s.Z)({"Content-Type":"application/json"},this.getAuthHeader()),body:JSON.stringify(e)})},e.getRateLimitCaptchaId=function(e){var t=this;return(0,o.Z)(function(){return(0,c.__generator)(this,function(n){switch(n.label){case 0:return[4,t.fetch("".concat(v,"/check_data_captcha"),{method:"GET",headers:(0,s.Z)({"Content-Type":"application/json"},t.getAuthHeader(e))})];case 1:return[2,n.sent()]}})})()},e.getRateLimitCaptchaItem=function(e,t){return this.fetch("".concat(v,"/data_captcha/").concat(e),{method:"GET",headers:(0,s.Z)({"Content-Type":"application/json"},this.getAuthHeader(t))})},e.getCaptchaDisplayStatus=function(e){return this.fetch("".concat(v,"/crosswalk"),{method:"GET",headers:(0,s.Z)({"Content-Type":"application/json"},this.getAuthHeader(e))})},e.submitRateLimitCaptchaResponse=function(e,t){return this.fetch("".concat(v,"/data_captcha/").concat(e.captchaId),{method:"POST",headers:(0,s.Z)({"Content-Type":"application/json"},this.getAuthHeader(t)),body:JSON.stringify({payload:e.payload,metadata:e.metadata})})},e.submitCheckoutForm=function(){return this.fetch("".concat(v,"/payments/checkout"),{method:"POST",headers:(0,s.Z)({"Content-Type":"application/json"},this.getAuthHeader())})},e.fetchCustomerPortalUrl=function(){return this.fetch("".concat(v,"/payments/customer_portal"),{method:"GET",headers:(0,s.Z)({"Content-Type":"application/json"},this.getAuthHeader())})},e.getAccountStatus=function(e){return this.fetch("".concat(v,"/accounts/check"),{method:"GET",headers:(0,s.Z)({"Content-Type":"application/json"},this.getAuthHeader(e))})},e.postAccountStatusWithCustomerSessionId=function(e,t){return this.fetch("".concat(v,"/payments/checkout_session"),{method:"POST",headers:(0,s.Z)({"Content-Type":"application/json"},this.getAuthHeader(t)),body:JSON.stringify({stripe_checkout_session_id:e})})},e}();T.auth0Client=null;var _=T}}]);